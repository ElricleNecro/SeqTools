language: python
cache: pip
python:
  - '3.6'
install:
  - pip install -U pip wheel
  - pip install -e .
  - pip install nose
  - pip install pytest pytest-cov pytest-timeout
  - pip install codacy-coverage
  - pip install sphinx
  - pip install sphinx_rtd_theme
script:
  - py.test --cov-report=xml --cov=lproc tests/
  - python -m sphinx -M doctest docs docs/_build
after_success:
  - python-codacy-coverage -r coverage.xml
deploy:
  provider: pypi
  user: $PYPI_USER
  password: $PYPI_PASS
  skip_cleanup: true
  on:
    tags: true
    branch: master
    python: "3.6"
